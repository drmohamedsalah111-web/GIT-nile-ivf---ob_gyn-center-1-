# โ๏ธ ุฎุทูุฉ ูููุฉ ุฌุฏุงู - ุชูููุฐ SQL Script

## ๐ด ูุฌุจ ุชูููุฐ ูุฐู ุงูุฎุทูุฉ ูุจู ุงุณุชุฎุฏุงู ูุธุงู ุงูููุงุชูุฑ!

---

## ๐ ุงูุทุฑููุฉ ุงูุฃููู: Supabase Dashboard (ููุตู ุจูุง)

### ุงูุฎุทูุงุช:

1. **ุงูุชุญ Supabase Dashboard:**
   ```
   https://app.supabase.com
   ```

2. **ุงุฎุชุฑ ูุดุฑูุนู** (Nile IVF Clinic)

3. **ุงุฐูุจ ุฅูู SQL Editor:**
   ```
   ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ โ SQL Editor
   ```

4. **ุงูุชุญ ููู `CREATE_INVOICE_ITEMS_TABLE.sql`** ูู VS Code

5. **ุงูุณุฎ ุงููุญุชูู ูุงููุงู** (Ctrl+A ุซู Ctrl+C)

6. **ุงูุตู ูู Supabase SQL Editor** (Ctrl+V)

7. **ุงุถุบุท ุฒุฑ "Run"** ุฃู ุงุถุบุท **Ctrl+Enter**

8. **ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ:**
   ```
   โ Success. Executed in X ms
   ```

---

## ๐ ุงูุทุฑููุฉ ุงูุซุงููุฉ: ูู VS Code ูุจุงุดุฑุฉ

ุฅุฐุง ูุงู ูุฏูู Supabase Extension ูู VS Code:

1. **ุงูุชุญ ููู `CREATE_INVOICE_ITEMS_TABLE.sql`**

2. **ุงุถุบุท F5** ุฃู **Right-click โ Execute SQL**

3. **ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ**

---

## โ ูุงุฐุง ุณูุญุฏุซ ุนูุฏ ุชูููุฐ ุงูุณูุฑูุจุชุ

ุงูุณูุฑูุจุช ุณูููู ุจู:

### 1. ุฅูุดุงุก ุฌุฏูู `invoice_items`
```sql
- id (UUID)
- invoice_id (UUID - Foreign Key)
- description (ุงููุต)
- quantity (ุงููููุฉ)
- unit_price (ุณุนุฑ ุงููุญุฏุฉ)
- total (ุงููุฌููุน)
- created_at (ุชุงุฑูุฎ ุงูุฅูุดุงุก)
- updated_at (ุชุงุฑูุฎ ุงูุชุญุฏูุซ)
```

### 2. ุฅูุดุงุก Indexes ููุฃุฏุงุก
```sql
- idx_invoice_items_invoice_id
- idx_invoices_invoice_number
- idx_invoices_created_by
```

### 3. ุชูุนูู RLS (Row Level Security)
```sql
- ุงูุณูุฑุชูุฑุฉ ุชุฑู ููุท ููุงุชูุฑ ุนูุงุฏุชูุง
- ุงูุฏูุชูุฑ ูุฑู ููุท ููุงุชูุฑ ุนูุงุฏุชู
```

### 4. ุฅุถุงูุฉ ุฃุนูุฏุฉ ุฌุฏูุฏุฉ ูุฌุฏูู `invoices`
```sql
- invoice_number (ุฑูู ุงููุงุชูุฑุฉ)
- invoice_type (ููุน ุงููุงุชูุฑุฉ)
- created_by (ูู ุฃูุดุฃ ุงููุงุชูุฑุฉ)
```

---

## ๐ ููู ุชุชุฃูุฏูู ูู ูุฌุงุญ ุงูุชูููุฐุ

### ุงูุทุฑููุฉ 1: ูู Supabase Dashboard

1. ุงุฐูุจ ุฅูู **Table Editor**
2. ูุฌุจ ุฃู ุชุฑู ุฌุฏูู ุฌุฏูุฏ ุงุณูู **`invoice_items`**
3. ุงูุชุญู ูุชุฃูุฏ ูู ุงูุฃุนูุฏุฉ

### ุงูุทุฑููุฉ 2: ุชูููุฐ ุงุณุชุนูุงู ุชุญูู

```sql
-- ููุฐ ูุฐุง ุงูุงุณุชุนูุงู ูู SQL Editor:
SELECT 
    table_name, 
    column_name, 
    data_type 
FROM information_schema.columns 
WHERE table_name = 'invoice_items'
ORDER BY ordinal_position;
```

ูุฌุจ ุฃู ุชุญุตู ุนูู ูุชูุฌุฉ ูุซู:
```
table_name       | column_name  | data_type
-----------------+--------------+-----------
invoice_items    | id           | uuid
invoice_items    | invoice_id   | uuid
invoice_items    | description  | text
invoice_items    | quantity     | numeric
invoice_items    | unit_price   | numeric
invoice_items    | total        | numeric
invoice_items    | created_at   | timestamp
invoice_items    | updated_at   | timestamp
```

### ุงูุทุฑููุฉ 3: ูู ุงูุชุทุจูู

1. ุณุฌูู ุงูุฏุฎูู ูุณูุฑุชูุฑุฉ
2. ุงุถุบุทู ุนูู ุฒุฑ "ุงูููุงุชูุฑ"
3. ุงุถุบุทู "ูุงุชูุฑุฉ ุฌุฏูุฏุฉ"
4. ุฅุฐุง ูุชุญ ุงููููุฐุฌ ุจุฏูู ุฃุฎุทุงุก โ โ ูุฌุญ!

---

## ๐ ุญู ุงููุดุงูู

### ุงููุดููุฉ: "relation invoice_items does not exist"

**ุงูุณุจุจ:** ูู ูุชู ุชูููุฐ ุงูุณูุฑูุจุช ุจุนุฏ

**ุงูุญู:**
```
1. ุงูุชุญ Supabase SQL Editor
2. ุงูุณุฎ ูุญุชูู CREATE_INVOICE_ITEMS_TABLE.sql
3. ุงูุตูู ูููุฐู ุจู Run
```

---

### ุงููุดููุฉ: "column invoice_number does not exist"

**ุงูุณุจุจ:** ุงูุณูุฑูุจุช ูู ููุชูู ุชูููุฐู

**ุงูุญู:**
```sql
-- ููุฐ ูุฐุง ูู SQL Editor:
ALTER TABLE invoices ADD COLUMN IF NOT EXISTS invoice_number TEXT UNIQUE;
ALTER TABLE invoices ADD COLUMN IF NOT EXISTS invoice_type TEXT DEFAULT 'Service';
ALTER TABLE invoices ADD COLUMN IF NOT EXISTS created_by UUID;
```

---

### ุงููุดููุฉ: "permission denied for table invoice_items"

**ุงูุณุจุจ:** RLS Policies ูู ุชููุฐ

**ุงูุญู:**
```
1. ุชุฃูุฏ ูู ุชูููุฐ ูุงูู ุงูุณูุฑูุจุช
2. ุฃุนุฏ ุชุณุฌูู ุงูุฏุฎูู
3. ุฌุฑุจ ูุฑุฉ ุฃุฎุฑู
```

---

### ุงููุดููุฉ: ูุธูุฑ ุฎุทุฃ ุนูุฏ ุงูุชูููุฐ

**ุงูุญู:**
```
1. ุชุฃูุฏ ูู ุฃูู ูููุฐ ุงูุณูุฑูุจุช ูุงููุงู (92 ุณุทุฑ)
2. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก ุฅููุงุฆูุฉ
3. ุฌุฑุจ ุชูููุฐ ูู ุฌุฒุก ุนูู ุญุฏุฉ:
   - ุฃููุงู: ุฅูุดุงุก ุงูุฌุฏูู
   - ุซุงููุงู: ุฅูุดุงุก ุงูู Indexes
   - ุซุงูุซุงู: ุชูุนูู RLS
   - ุฑุงุจุนุงู: ุฅุถุงูุฉ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
```

---

## ๐ ุงูุชุญูู ุงูููุงุฆู

ุจุนุฏ ุงูุชูููุฐุ ูุฌุจ ุฃู:

- [x] ุฌุฏูู `invoice_items` ููุฌูุฏ
- [x] ุฃุนูุฏุฉ ุฌุฏูุฏุฉ ูู ุฌุฏูู `invoices`:
  - `invoice_number`
  - `invoice_type`
  - `created_by`
- [x] RLS Policies ููุนูุฉ
- [x] Indexes ุชู ุฅูุดุงุคูุง
- [x] ูุง ุชูุฌุฏ ุฃุฎุทุงุก

---

## โ ุงุฎุชุจุงุฑ ุณุฑูุน

ููุฐ ูุฐุง ุงูุงุณุชุนูุงู ููุชุฃูุฏ:

```sql
-- ุงุฎุชุจุงุฑ 1: ุฌุฏูู invoice_items ููุฌูุฏุ
SELECT COUNT(*) as exists 
FROM information_schema.tables 
WHERE table_name = 'invoice_items';
-- ูุฌุจ ุฃู ุชุญุตู ุนูู: 1

-- ุงุฎุชุจุงุฑ 2: ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ ููุฌูุฏุฉุ
SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'invoices' 
AND column_name IN ('invoice_number', 'invoice_type', 'created_by');
-- ูุฌุจ ุฃู ุชุญุตู ุนูู: 3 rows

-- ุงุฎุชุจุงุฑ 3: RLS ููุนูุ
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'invoice_items';
-- ูุฌุจ ุฃู ุชุญุตู ุนูู: rowsecurity = true
```

---

## ๐ ุจุนุฏ ุงูุชูููุฐ ุงููุงุฌุญ

ุงูุขู ููููู:

1. โ ูุชุญ ุงูุชุทุจูู
2. โ ุงูุฐูุงุจ ูุตูุญุฉ ุงูููุงุชูุฑ
3. โ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ
4. โ ุญูุธ ุงููุงุชูุฑุฉ
5. โ ุทุจุงุนุฉ ุงููุงุชูุฑุฉ

---

## ๐ ูู ุชุญุชุงุฌ ูุณุงุนุฏุฉุ

ุฅุฐุง ูุงุฌูุชู ุฃู ูุดุงูู:

1. **ุชุญูู ูู console** ูู ุงููุชุตูุญ (F12)
2. **ุฑุงุฌุน Supabase Logs** ูู Dashboard
3. **ููุฐ ุงุณุชุนูุงูุงุช ุงูุชุญูู** ุฃุนูุงู
4. **ุชุฃูุฏ ูู ุชูููุฐ ุงูุณูุฑูุจุช ูุงููุงู**

---

## ๐ ุฌุงูุฒุ

ุจุนุฏ ุชูููุฐ ุงูุณูุฑูุจุช:

```
โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ
โ ุงูุฌุฏุงูู ุชู ุฅูุดุงุคูุง
โ ุงูุตูุงุญูุงุช ุชู ุชูุนูููุง
โ ูุธุงู ุงูููุงุชูุฑ ุฌุงูุฒ ููุงุณุชุฎุฏุงู

โ ุงุจุฏุฃ ุงูุขู! ๐
```

---

## ๐ ูููุงุช ูุณุงุนุฏุฉ

- `CREATE_INVOICE_ITEMS_TABLE.sql` - ุงูุณูุฑูุจุช ุงูุฃุตูู
- `INVOICES_QUICK_START.md` - ุฏููู ุงูุจุฏุก ุงูุณุฑูุน
- `HOW_TO_ADD_INVOICE.txt` - ููููุฉ ุฅุถุงูุฉ ูุงุชูุฑุฉ
- `VISUAL_GUIDE_INVOICES.md` - ุฏููู ูุตูุฑ

**ุจุงูุชูููู! ๐**
