# ุญู ูุดููุฉ ุนูุงูุงุช ุงูุงุณุชููุงู ูู ุงููุตูุต ุงูุนุฑุจูุฉ

## ุงููุดููุฉ

ุงููุตูุต ุงูุนุฑุจูุฉ ุชุธูุฑ ูู `????` ุฃู `????????` ุจุฏูุงู ูู ุงููุต ุงููุนูู:
- ุงูุนููุงู ูุธูุฑ: `???? ??????? (IVF)` ุจุฏูุงู ูู: `ุฏูุฑุฉ ุงููุฑูุถุฉ (IVF)`
- ุงูุฃุฒุฑุงุฑ ุชุธูุฑ: `?? ????? ??????` ุจุฏูุงู ูู: `ุจุฏุก ุฏูุฑุฉ ุฌุฏูุฏุฉ`

---

## ุฌุฐูุฑ ุงููุดููุฉ (Mojibake)

ููุงู **3 ูุณุชููุงุช** ูุฏ ุชุญุชูู ุนูู ุชุดููุฑ ูุนุทูุจ:

### โ **ุงููุณุชูู 1: ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend) - ูุตุญุญ**

**ุงููุดููุฉ:**  
ููู `pages/IvfJourney.tsx` ูุญุชูู ุนูู ูุตูุต ุนุฑุจูุฉ ูุนุทูุจุฉ ูุญูููุง:
```typescript
arabicName: '???????? ???????? ???????'  // ูุนุทูุจ
```

**ุงูุญู ุงููุทุจู:**  
ุงุณุชุจุฏุงู ุงููุตูุต ุงููุนุทูุจุฉ ุจู import ูู `constants.ts` ุงูุชู ุชุญุชูู ุนูู ุงููุตูุต ุงูุตุญูุญุฉ:
```typescript
import { PROTOCOL_INFO } from '../constants';
// โ ุงูุขู ูุณุชุฎุฏู ุงููุตูุต ุงูุตุญูุญุฉ:
// arabicName: 'ุจุฑูุชูููู ุงููุงูุถุงุช ุงูุทูููุฉ'
```

### ๐ง **ุงููุณุชูู 2: ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database) - ูุญุชุงุฌ ุฅุตูุงุญ**

**ุงููุดููุฉ:**  
ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฏ ุชุญุชูู ุนูู ูุตูุต ุนุฑุจูุฉ ูุนุทูุจุฉ:
- `app_settings` - ุงุณู ุงูุนูุงุฏุฉ ูุงูุนููุงู
- `patients` - ุฃุณูุงุก ุงููุฑูุถุงุช ูุงูุฃุฒูุงุฌ
- `visits` - ุงูุชุดุฎูุต ูุงูููุงุญุธุงุช
- `prescriptions` - ุฃุณูุงุก ุงูุฃุฏููุฉ ูุงูููุงุญุธุงุช
- `infertility_workups` - ุงูููุงุญุธุงุช ุงูุณุฑูุฑูุฉ
- `obstetric_visits` - ููุงุญุธุงุช ุงูุญูู

**ุงูุญู:**  
ุชุดุบูู script `FIX_ALL_ARABIC_ENCODING.sql` ุงูุฐู ูุตูุญ ูู ุงูุฌุฏุงูู

### โ **ุงููุณุชูู 3: HTML Meta Tags - ุตุญูุญ**

```html
<!DOCTYPE html>
<html lang="en" dir="rtl">
  <head>
    <meta charset="UTF-8" />  <!-- โ ุตุญูุญ -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal..." />  <!-- โ ุฎุท ุนุฑุจู -->
  </head>
</html>
```

---

## ุฎุทูุงุช ุงูุฅุตูุงุญ ุงููุงููุฉ

### ุงูุฎุทูุฉ 1: ุชุญุฏูุซ ุงูููุฏ (ุชู โ)

โ **ุชู ุฅุตูุงุญ:** `pages/IvfJourney.tsx`
- ุงูุขู ูุณุชูุฑุงุฏ `PROTOCOL_INFO` ูู `constants.ts`
- ุฌููุน ุงููุตูุต ุงูุนุฑุจูุฉ ุตุญูุญุฉ

### ุงูุฎุทูุฉ 2: ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช

1. **ูุชุญ Supabase Dashboard**
2. **ุงุฐูุจ ุฅูู SQL Editor**
3. **ุฅูุดุงุก query ุฌุฏูุฏ**
4. **ูุณุฎ ูุญุชููุงุช** `FIX_ALL_ARABIC_ENCODING.sql`
5. **ุชุดุบูู ุงูู script** (โถ๏ธ ุฒุฑ ุงูุชุดุบูู)
6. **ุงูุงูุชุธุงุฑ ููุฅููุงู** (ูุฌุจ ุฃู ููุธูุฑ ุชุญูู verification 0 ุตููู ูุนุทูุจุฉ)

### ุงูุฎุทูุฉ 3: ุฅุนุงุฏุฉ ุชุญููู ุงูุชุทุจูู

1. **ุฅุบูุงู ุงููุชุตูุญ ุชูุงูุงู** (ุฃู ูุชุญ Incognito window ุฌุฏูุฏ)
2. **Hard refresh:** `Ctrl+Shift+R` (Windows) ุฃู `Cmd+Shift+R` (Mac)
3. **ุงุฎุชุจุงุฑ ุงููุตูุต ุงูุนุฑุจูุฉ:**
   - ุงูุนููุงู ุงูุฑุฆูุณู
   - ุงูุฃุฒุฑุงุฑ ูุงูููุงุฆู
   - ุจูุงูุงุช ุงููุฑูุถุงุช

---

## ูุง ุงูุฐู ุชู ุฅุตูุงุญู ุจุงููุนู

### โ File: `pages/IvfJourney.tsx`

**Before:**
```typescript
const PROTOCOL_INFO: any = {
  'Long': {
    arabicName: '???????? ???????? ???????',  // โ ูุนุทูุจ
  },
  'Antagonist': {
    arabicName: '???????? ????????',  // โ ูุนุทูุจ
  }
};
```

**After:**
```typescript
import { PROTOCOL_INFO } from '../constants';  // โ ุงุณุชูุฑุงุฏ ุตุญูุญ
// ุงูุขู ูุณุชุฎุฏู:
// arabicName: 'ุจุฑูุชูููู ุงููุงูุถุงุช ุงูุทูููุฉ' โ
// arabicName: 'ุจุฑูุชูููู ุงููุถุงุฏุงุช' โ
```

### โ File: `constants.ts`

ุฌููุน ุงููุตูุต ุงูุนุฑุจูุฉ ุตุญูุญุฉ ูููุซูุฉ:
```typescript
'Long': {
  name: 'Long Agonist Protocol',
  arabicName: 'ุจุฑูุชูููู ุงููุงูุถุงุช ุงูุทูููุฉ',  // โ ุตุญูุญ
  arabicDescription: 'ุงูุฃูุซุฑ ุงุณุชุฎุฏุงูุงู...',  // โ ุตุญูุญ
}
```

---

## Database Fix - `FIX_ALL_ARABIC_ENCODING.sql`

ูุฐุง ุงูู script ูุตูุญ:

| ุงูุฌุฏูู | ุงูุฃุนูุฏุฉ ุงููุตุญุญุฉ |
|--------|-----------------|
| `app_settings` | clinic_name, clinic_address, clinic_phone |
| `patients` | name, husband_name, history |
| `visits` | diagnosis, notes |
| `prescriptions` | drug_name, notes |
| `infertility_workups` | assessment_notes, clinical_impression, recommendations |
| `obstetric_visits` | clinical_notes, assessment, plan |
| `ivf_cycles` | assessment_data, lab_data, transfer_data, outcome_data (JSONB) |

---

## ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุชุดุบูู ุงูู scriptุ ูุฌุจ ุฃู ุชุฑู:

```
table_name             | corrupted_rows
-----------------------+---------------
app_settings           | 0
patients               | 0
visits                 | 0
prescriptions          | 0
(No results = ุฌููุน ุงูุฌุฏุงูู ูุธููุฉ โ)
```

ุฅุฐุง ุฑุฃูุช ุฃู ุฑูู ุฃูุจุฑ ูู 0ุ ูู ุจู:
1. ุชุดุบูู `FIX_ARABIC_MOJIBAKE.sql` ูู JSONB columns
2. ุชูุฑุงุฑ ุงูุชุญูู

---

## ุงูุงุฎุชุจุงุฑ ูู ุงูุชุทุจูู

ุจุนุฏ ุงูุฅุตูุงุญ ุงููุงููุ ูุฌุจ ุฃู ุชุธูุฑ:

### โ ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ
- ุงูุนููุงู: `ุฏูุฑุฉ ุงููุฑูุถุฉ (IVF)`
- ุงููุตู: `ูุธุงู ุดุงูู ูุฅุฏุงุฑุฉ ุฏูุฑุงุช ุงูุญูู`
- ุงูุฒุฑ: `ุจุฏุก ุฏูุฑุฉ ุฌุฏูุฏุฉ`

### โ ุงุฎุชูุงุฑ ุงููุฑูุถุฉ
- ุฃุณูุงุก ุงููุฑูุถุงุช ุจุงูุนุฑุจูุฉ
- ุจูุงูุงุช ุงููุฑูุถุฉ ูุงููุฉ

### โ ุงูุชุจููุจุงุช
- ุงูุชูููู ุงูุฃููู
- ุงูุณุฌูุงุช
- ุงููุนูู
- ุงููุชุงุฆุฌ

### โ ุงูุจูุงูุงุช ุงููุญููุธุฉ
- ุงูููุงุญุธุงุช ุงูุณุฑูุฑูุฉ
- ุงูุฃุฏููุฉ ูุงูุฌุฑุนุงุช
- ุชูุตูุงุช ุงูุนูุงุฌ

---

## ุงููููุงุช ุฐุงุช ุงูุตูุฉ

| ุงูููู | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|------|--------|----------|
| `index.html` | โ ุตุญูุญ | Meta charset ู RTL ุตุญูุญ |
| `constants.ts` | โ ุตุญูุญ | ูู ุงููุตูุต ุงูุนุฑุจูุฉ ุตุญูุญุฉ |
| `pages/IvfJourney.tsx` | โ ูุตุญุญ | ุงูุขู ูุณุชูุฑุงุฏ ูู constants |
| `FIX_ALL_ARABIC_ENCODING.sql` | โณ ูุญุชุงุฌ ุชุดุบูู | ูุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| `FIX_ARABIC_MOJIBAKE.sql` | โณ ุงุฎุชูุงุฑู | ุฅุฐุง ูุงู ููุงู ูุดุงูู JSONB |

---

## ุงูุฎูุงุตุฉ

**ุงููุดุงูู ุงููุตุญุญุฉ:**
1. โ Removed hardcoded corrupted Arabic from `IvfJourney.tsx`
2. โ Using `PROTOCOL_INFO` from `constants.ts` (correct)
3. โณ Pending: Database fixes with SQL script

**ุงูุฎุทูุงุช ุงููุชุจููุฉ:**
1. ุชุดุบูู `FIX_ALL_ARABIC_ENCODING.sql` ูู Supabase
2. Hard refresh ุงููุชุตูุญ
3. ุงุฎุชุจุงุฑ ุงููุตูุต ุงูุนุฑุจูุฉ

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงููุตูุต ุงูุนุฑุจูุฉ ุชุจุฏู ูู `????` ุฃู `????????`

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุดุบูู `FIX_ALL_ARABIC_ENCODING.sql`
2. ุชุญูู ูู output ุงูุชุญูู - ูุฌุจ ุฃู ูููู 0
3. Hard refresh: `Ctrl+Shift+R`

### ุงููุดููุฉ: ุจุนุถ ุงููุตูุต ุตุญูุญุฉ ูุจุนุถูุง ูุนุทูุจ

**ุงูุณุจุจ:**  
ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุตุญูุญุฉุ ุงูุจูุงูุงุช ุงููุฏููุฉ ูุนุทูุจุฉ

**ุงูุญู:**  
ุชุดุบูู ุงูู script ุณูุตูุญ ูู ุงูุจูุงูุงุช ุงููุฏููุฉ

### ุงููุดููุฉ: ุงูุฎุท ุงูุนุฑุจู ุถุนูู ุฃู ุบูุฑ ูุงุถุญ

**ุงูุญู:**
```html
<!-- Already correct in index.html -->
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
```

---

## ุณุคุงู ูุฌูุงุจ

**ุณ: ูู ุณุฃููุฏ ุจูุงูุงุช ุนูุฏ ุงูุชุตุญูุญุ**  
ุฌ: ูุงุ ุงูู script ูุตุญุญ ุงูุจูุงูุงุช ููุทุ ูุง ูุญุฐู ุฃู ุดูุก.

**ุณ: ูู ูุคุซุฑ ุนูู ุงูุฃุฏุงุกุ**  
ุฌ: ูุงุ ุงูู script ุณุฑูุน ุฌุฏุงู (ุซูุงูู ูุนุฏูุฏุฉ).

**ุณ: ูู ูุญุชุงุฌ ูุงุนุฏุฉ ุจูุงูุงุช ุฌุฏูุฏุฉุ**  
ุฌ: ูุงุ ูุนูู ุนูู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ.

**ุณ: ูู ุณูุคุซุฑ ุนูู ุงููุณุชุฎุฏููู ุงูุขุฎุฑููุ**  
ุฌ: ูุงุ ุงูุนูููุฉ ุขููุฉ ุชูุงูุงู ููุง ุชุชุทูุจ ุชููู ุงูุชุทุจูู.

---

## ุงูุชุทููุฑ ุงููุณุชูุจูู

ูุชุฌูุจ ูุฐู ุงููุดุงูู:

1. **ุงุณุชุฎุฏุงู UTF-8 ุฏุงุฆูุงู** ูู ูู ุงูููุงู
2. **ุงุฎุชุจุงุฑ ุงููุตูุต ุงูุนุฑุจูุฉ** ุจุนุฏ ูู ุชุญุฏูุซ
3. **ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** ุจู SQL ุดูุฑูุงู
4. **ุงุณุชุฎุฏุงู constants.ts** ููู ุงููุตูุต ุงูุซุงุจุชุฉ

---

## ููุฎุต ุณุฑูุน

```bash
# 1. ุชู ุงูุฅุตูุงุญ ูู ุงูููุฏ โ
# - pages/IvfJourney.tsx ุงูุขู ูุณุชูุฑุงุฏ ูู constants

# 2. ุชุดุบูู ูุฐุง ุงูู script ูู Supabase:
# - FIX_ALL_ARABIC_ENCODING.sql

# 3. Hard refresh ุงููุชุตูุญ
Ctrl+Shift+R

# 4. ุงุฎุชุจุงุฑ
# ุงููุตูุต ุงูุนุฑุจูุฉ ูุฌุจ ุฃู ุชุธูุฑ ุตุญูุญุฉ ุงูุขู! โ
```
